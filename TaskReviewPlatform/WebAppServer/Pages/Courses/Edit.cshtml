@page "{id:int}"
@model WebAppServer.Pages.Courses.EditModel
@{
    ViewData["Title"] = "Редактировать курс";
}

<h2>Редактирование курса: @Model.Course.Name</h2>

<form method="post" asp-page-handler="Update">
    <div class="mb-3">
        <label>Название</label>
        <input asp-for="Course.Name" class="form-control" />
    </div>
    <div class="mb-3">
        <label>Описание</label>
        <textarea asp-for="Course.Description" class="form-control"></textarea>
    </div>
    <button class="btn btn-success" type="submit">Сохранить</button>
</form>

<hr />

<h4>Участники</h4>
<ul>
    @foreach (var u in Model.Course.Participants)
    {
        <li>@u.Login (@u.Name)</li>
    }
</ul>

<form method="post" asp-page-handler="AddUser">
    <div class="input-group mb-3">
        <input asp-for="NewUserLogin" class="form-control" placeholder="Логин нового участника" />
        <button class="btn btn-primary" type="submit">Добавить</button>
    </div>
</form>

<hr />

<h4>Задания</h4>
<ul>
    @foreach (var t in Model.Course.Tasks)
    {
        <li>
            <a asp-page="/Tasks/Edit" asp-route-id="@t.Id">@t.Name</a>
        </li>
    }
</ul>

<form method="post" asp-page-handler="AddTask">
    <div class="mb-3">
        <label>Название задания</label>
        <input asp-for="NewTaskName" class="form-control" />
    </div>
    <div class="mb-3">
        <label>Описание задания</label>
        <textarea asp-for="NewTaskDescription" class="form-control"></textarea>
    </div>
    <button class="btn btn-primary" type="submit">Создать задание</button>
</form>

<hr />

<h4>Отчеты</h4>
<p class="text-muted">Сформируйте простой количественный отчет по заданиям и проверкам курса.</p>
<div class="d-flex flex-wrap gap-2 mb-3">
    <form method="post" asp-page-handler="DownloadReport" asp-route-id="@Model.Course.Id" class="d-inline">
        <input type="hidden" name="format" value="pdf" />
        <button class="btn btn-outline-primary" type="submit">Скачать отчет (PDF)</button>
    </form>
    <form method="post" asp-page-handler="DownloadReport" asp-route-id="@Model.Course.Id" class="d-inline">
        <input type="hidden" name="format" value="excel" />
        <button class="btn btn-outline-success" type="submit">Скачать отчет (Excel)</button>
    </form>
</div>

<hr />

<form method="post" asp-page-handler="DeleteCourse">
    <button class="btn btn-danger" onclick="return confirm('Удалить курс?');">Удалить курс</button>
</form>
